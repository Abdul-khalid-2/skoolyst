   // 0001_01_01_000001_create_users_table
    public function up(): void
    {
        Schema::create('users', function (Blueprint $table) {
            $table->id();
            $table->uuid('uuid')->unique();
            $table->string('name');
            $table->string('email')->unique();
            $table->timestamp('email_verified_at')->nullable();
            $table->string('password');
            $table->foreignId('school_id')->nullable()->constrained('schools')->onDelete('cascade');
            $table->rememberToken();
            $table->timestamps();
        });

        Schema::create('password_reset_tokens', function (Blueprint $table) {
            $table->string('email')->primary();
            $table->string('token');
            $table->timestamp('created_at')->nullable();
        });

        Schema::create('sessions', function (Blueprint $table) {
            $table->string('id')->primary();
            $table->foreignId('user_id')->nullable()->index();
            $table->string('ip_address', 45)->nullable();
            $table->text('user_agent')->nullable();
            $table->longText('payload');
            $table->integer('last_activity')->index();
        });
    }
    // 0001_01_01_000000_create_schools_table
    public function up()
    {
        Schema::create('schools', function (Blueprint $table) {
            $table->id(); // Auto-increment PK (hidden from outside)
            $table->uuid('uuid')->unique(); // Public-facing identifier

            $table->string('name');
            $table->string('email')->nullable()->unique();
            $table->string('address')->nullable();
            $table->string('city')->nullable();
            $table->string('contact_number')->nullable();
            $table->string('website')->nullable();

            $table->text('description')->nullable();
            $table->text('facilities')->nullable();

            $table->enum('school_type', ['Co-Ed', 'Boys', 'Girls'])->default('Co-Ed');

            // ðŸ’° Fees
            $table->decimal('regular_fees', 10, 2)->nullable();
            $table->decimal('discounted_fees', 10, 2)->nullable();
            $table->decimal('admission_fees', 10, 2)->nullable();

            // ðŸ“Œ Other fields
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->enum('visibility', ['public', 'private'])->default('public');
            $table->timestamp('publish_date')->nullable();

            $table->timestamps();

            // Indexes
            $table->index('name');
            $table->index('city');
            $table->index('school_type');
            $table->index('status');
        });
    }

    // 2025_09_17_213223_create_reviews_table
    public function up()
    {
        Schema::create('reviews', function (Blueprint $table) {
            $table->id(); // Primary key
            $table->foreignId('school_id')->constrained('schools')->onDelete('cascade'); // Foreign key for schools
            $table->text('review'); // Review content
            $table->integer('rating')->default(0); // Rating (1-5)
            $table->string('reviewer_name'); // Reviewer (Parent/Student)
            $table->timestamps(); // Created at, updated at
        });
    }


    // 2025_09_17_213404_create_events_table
    public function up(): void
    {
        Schema::create('events', function (Blueprint $table) {
            $table->id(); // Primary key
            $table->foreignId('school_id')->constrained('schools')->onDelete('cascade'); // Foreign key for schools
            $table->string('event_name'); // Event name
            $table->text('event_description'); // Event description
            $table->date('event_date'); // Event date
            $table->string('event_location'); // Event location
            $table->timestamps(); // Created at, updated at
        });
    }

    // 2025_09_18_213009_create_branches_table
    public function up()
    {
        Schema::create('branches', function (Blueprint $table) {
            $table->id();
            $table->foreignId('school_id')->constrained('schools')->onDelete('cascade');
            $table->string('name'); // Branch name (could be same as main school or different)
            $table->string('address');
            $table->string('city');
            $table->string('contact_number')->nullable();
            $table->string('branch_head_name')->nullable(); // Principal/Head of branch
            $table->decimal('latitude', 10, 8)->nullable(); // For maps
            $table->decimal('longitude', 11, 8)->nullable(); // For maps
            $table->boolean('is_main_branch')->default(false); // Flag for main branch
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->timestamps();

            // Indexes
            $table->index('school_id');
            $table->index('city');
            $table->index('is_main_branch');
        });
    }

    public function up()
    {
        Schema::table('events', function (Blueprint $table) {
            $table->foreignId('branch_id')->nullable()->after('school_id')
                ->constrained('branches')->onDelete('cascade');
        });
    }


    // 2025_09_18_213308_add_branch_id_to_reviews_table
    public function up()
    {
        Schema::table('reviews', function (Blueprint $table) {
            $table->foreignId('branch_id')
                ->nullable()
                ->after('school_id')
                ->constrained('branches')
                ->onDelete('cascade');
        });
    }

    // 2025_09_18_214550_create_personal_access_tokens_table
    public function up(): void
    {
        Schema::create('personal_access_tokens', function (Blueprint $table) {
            $table->id();
            $table->morphs('tokenable');
            $table->text('name');
            $table->string('token', 64)->unique();
            $table->text('abilities')->nullable();
            $table->timestamp('last_used_at')->nullable();
            $table->timestamp('expires_at')->nullable()->index();
            $table->timestamps();
        });
    }

    // 2025_09_18_233728_create_permission_tables
    public function up(): void
    {
        $teams = config('permission.teams');
        $tableNames = config('permission.table_names');
        $columnNames = config('permission.column_names');
        $pivotRole = $columnNames['role_pivot_key'] ?? 'role_id';
        $pivotPermission = $columnNames['permission_pivot_key'] ?? 'permission_id';

        throw_if(empty($tableNames), new Exception('Error: config/permission.php not loaded. Run [php artisan config:clear] and try again.'));
        throw_if($teams && empty($columnNames['team_foreign_key'] ?? null), new Exception('Error: team_foreign_key on config/permission.php not loaded. Run [php artisan config:clear] and try again.'));

        Schema::create($tableNames['permissions'], static function (Blueprint $table) {
            // $table->engine('InnoDB');
            $table->bigIncrements('id'); // permission id
            $table->string('name');       // For MyISAM use string('name', 225); // (or 166 for InnoDB with Redundant/Compact row format)
            $table->string('guard_name'); // For MyISAM use string('guard_name', 25);
            $table->timestamps();

            $table->unique(['name', 'guard_name']);
        });

        Schema::create($tableNames['roles'], static function (Blueprint $table) use ($teams, $columnNames) {
            // $table->engine('InnoDB');
            $table->bigIncrements('id'); // role id
            if ($teams || config('permission.testing')) { // permission.testing is a fix for sqlite testing
                $table->unsignedBigInteger($columnNames['team_foreign_key'])->nullable();
                $table->index($columnNames['team_foreign_key'], 'roles_team_foreign_key_index');
            }
            $table->string('name');       // For MyISAM use string('name', 225); // (or 166 for InnoDB with Redundant/Compact row format)
            $table->string('guard_name'); // For MyISAM use string('guard_name', 25);
            $table->timestamps();
            if ($teams || config('permission.testing')) {
                $table->unique([$columnNames['team_foreign_key'], 'name', 'guard_name']);
            } else {
                $table->unique(['name', 'guard_name']);
            }
        });

        Schema::create($tableNames['model_has_permissions'], static function (Blueprint $table) use ($tableNames, $columnNames, $pivotPermission, $teams) {
            $table->unsignedBigInteger($pivotPermission);

            $table->string('model_type');
            $table->unsignedBigInteger($columnNames['model_morph_key']);
            $table->index([$columnNames['model_morph_key'], 'model_type'], 'model_has_permissions_model_id_model_type_index');

            $table->foreign($pivotPermission)
                ->references('id') // permission id
                ->on($tableNames['permissions'])
                ->onDelete('cascade');
            if ($teams) {
                $table->unsignedBigInteger($columnNames['team_foreign_key']);
                $table->index($columnNames['team_foreign_key'], 'model_has_permissions_team_foreign_key_index');

                $table->primary([$columnNames['team_foreign_key'], $pivotPermission, $columnNames['model_morph_key'], 'model_type'],
                    'model_has_permissions_permission_model_type_primary');
            } else {
                $table->primary([$pivotPermission, $columnNames['model_morph_key'], 'model_type'],
                    'model_has_permissions_permission_model_type_primary');
            }

        });

        Schema::create($tableNames['model_has_roles'], static function (Blueprint $table) use ($tableNames, $columnNames, $pivotRole, $teams) {
            $table->unsignedBigInteger($pivotRole);

            $table->string('model_type');
            $table->unsignedBigInteger($columnNames['model_morph_key']);
            $table->index([$columnNames['model_morph_key'], 'model_type'], 'model_has_roles_model_id_model_type_index');

            $table->foreign($pivotRole)
                ->references('id') // role id
                ->on($tableNames['roles'])
                ->onDelete('cascade');
            if ($teams) {
                $table->unsignedBigInteger($columnNames['team_foreign_key']);
                $table->index($columnNames['team_foreign_key'], 'model_has_roles_team_foreign_key_index');

                $table->primary([$columnNames['team_foreign_key'], $pivotRole, $columnNames['model_morph_key'], 'model_type'],
                    'model_has_roles_role_model_type_primary');
            } else {
                $table->primary([$pivotRole, $columnNames['model_morph_key'], 'model_type'],
                    'model_has_roles_role_model_type_primary');
            }
        });

        Schema::create($tableNames['role_has_permissions'], static function (Blueprint $table) use ($tableNames, $pivotRole, $pivotPermission) {
            $table->unsignedBigInteger($pivotPermission);
            $table->unsignedBigInteger($pivotRole);

            $table->foreign($pivotPermission)
                ->references('id') // permission id
                ->on($tableNames['permissions'])
                ->onDelete('cascade');

            $table->foreign($pivotRole)
                ->references('id') // role id
                ->on($tableNames['roles'])
                ->onDelete('cascade');

            $table->primary([$pivotPermission, $pivotRole], 'role_has_permissions_permission_id_role_id_primary');
        });

        app('cache')
            ->store(config('permission.cache.store') != 'default' ? config('permission.cache.store') : null)
            ->forget(config('permission.cache.key'));
    }


    // 2025_10_02_204529_create_pages_table
    public function up()
    {
        Schema::create('pages', function (Blueprint $table) {
            $table->id(); // Auto-increment primary key
            $table->uuid('uuid')->unique();
            $table->foreignId('school_id')->constrained('schools')->onDelete('cascade');
            $table->foreignId('event_id')->nullable()->constrained('events')->onDelete('cascade');
            $table->string('name')->notNullable();
            $table->string('slug')->nullable();
            $table->json('structure')->notNullable(); // This will store your form data
            $table->timestamps(); // created_at and updated_at

            // Indexes
            $table->index('event_id');
            $table->index('slug');
            $table->index('name');
        });
    }

    // 2025_10_02_211339_add_status_to_events_table
    public function up()
    {
        Schema::table('events', function (Blueprint $table) {
            $table->enum('status', ['active', 'inactive'])->default('active');
        });
    }

    // 2025_10_18_064945_create_school_images_table
    public function up(): void
    {
        Schema::create('school_images', function (Blueprint $table) {
            $table->id();
            $table->foreignId('school_id')->constrained('schools')->onDelete('cascade');

            $table->string('image_path');   // store file path
            $table->string('title')->nullable(); // image title/caption
            $table->timestamps();
            $table->index('school_id');
        });
    }

    // 2025_10_18_065015_add_banner_image_to_schools_table
    public function up(): void
    {
        Schema::table('schools', function (Blueprint $table) {
            $table->string('banner_image')->nullable()->after('description');
        });
    }


    // 2025_10_21_035303_create_features_table
    public function up()
    {
        Schema::create('features', function (Blueprint $table) {
            $table->id();
            $table->string('name')->unique();
            $table->string('category')->default('general');
            $table->string('icon')->nullable();
            $table->text('description')->nullable();
            $table->timestamps();

            $table->index('category');
        });
    }

    // 2025_10_21_035310_create_school_feature_table
    public function up()
    {
        Schema::create('school_feature', function (Blueprint $table) {
            $table->id();
            $table->foreignId('school_id')->constrained()->onDelete('cascade');
            $table->foreignId('feature_id')->constrained()->onDelete('cascade');
            $table->text('description')->nullable();
            $table->integer('priority')->default(0);
            $table->timestamps();

            $table->unique(['school_id', 'feature_id']);
            $table->index('priority');
        });
    }

    // 2025_10_21_035317_create_curriculums_table
    public function up()
    {
        Schema::create('curriculums', function (Blueprint $table) {
            $table->id();
            $table->string('name')->unique();
            $table->string('code')->unique();
            $table->text('description')->nullable();
            $table->timestamps();
        });
    }


// 2025_10_21_035325_create_school_curriculum_table
    public function up()
    {
        Schema::create('school_curriculum', function (Blueprint $table) {
            $table->id();
            $table->foreignId('school_id')->constrained()->onDelete('cascade');
            $table->foreignId('curriculum_id')->constrained('curriculums')->onDelete('cascade'); // Explicitly specify table name
            $table->timestamps();

            $table->unique(['school_id', 'curriculum_id']);
        });
    }

    // 2025_10_22_064141_add_banner_fields_to_schools_table
    public function up(): void
    {
        Schema::table('schools', function (Blueprint $table) {
            $table->string('banner_title')->nullable()->after('banner_image');
            $table->string('banner_tagline')->nullable()->after('banner_title');
        });
    }


   // 0001_01_01_000001_create_users_table
    public function up(): void
    {
        Schema::create('users', function (Blueprint $table) {
            $table->id();
            $table->uuid('uuid')->unique();
            $table->string('name');
            $table->string('email')->unique();
            $table->timestamp('email_verified_at')->nullable();
            $table->string('password');
            $table->foreignId('school_id')->nullable()->constrained('schools')->onDelete('cascade');
            $table->rememberToken();
            $table->timestamps();
        });

        Schema::create('password_reset_tokens', function (Blueprint $table) {
            $table->string('email')->primary();
            $table->string('token');
            $table->timestamp('created_at')->nullable();
        });

        Schema::create('sessions', function (Blueprint $table) {
            $table->string('id')->primary();
            $table->foreignId('user_id')->nullable()->index();
            $table->string('ip_address', 45)->nullable();
            $table->text('user_agent')->nullable();
            $table->longText('payload');
            $table->integer('last_activity')->index();
        });
    }
    // 0001_01_01_000000_create_schools_table
    public function up()
    {
        Schema::create('schools', function (Blueprint $table) {
            $table->id(); // Auto-increment PK (hidden from outside)
            $table->uuid('uuid')->unique(); // Public-facing identifier

            $table->string('name');
            $table->string('email')->nullable()->unique();
            $table->string('address')->nullable();
            $table->string('city')->nullable();
            $table->string('contact_number')->nullable();
            $table->string('website')->nullable();

            $table->text('description')->nullable();
            $table->text('facilities')->nullable();

            $table->enum('school_type', ['Co-Ed', 'Boys', 'Girls'])->default('Co-Ed');

            // ðŸ’° Fees
            $table->decimal('regular_fees', 10, 2)->nullable();
            $table->decimal('discounted_fees', 10, 2)->nullable();
            $table->decimal('admission_fees', 10, 2)->nullable();

            // ðŸ“Œ Other fields
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->enum('visibility', ['public', 'private'])->default('public');
            $table->timestamp('publish_date')->nullable();

            $table->timestamps();

            // Indexes
            $table->index('name');
            $table->index('city');
            $table->index('school_type');
            $table->index('status');
        });
    }


    // 2025_09_17_213223_create_reviews_table
    public function up()
    {
        Schema::create('reviews', function (Blueprint $table) {
            $table->id(); // Primary key
            $table->foreignId('school_id')->constrained('schools')->onDelete('cascade'); // Foreign key for schools
            $table->text('review'); // Review content
            $table->integer('rating')->default(0); // Rating (1-5)
            $table->string('reviewer_name'); // Reviewer (Parent/Student)
            $table->timestamps(); // Created at, updated at
        });
    }


    // 2025_09_17_213404_create_events_table
    public function up(): void
    {
        Schema::create('events', function (Blueprint $table) {
            $table->id(); // Primary key
            $table->foreignId('school_id')->constrained('schools')->onDelete('cascade'); // Foreign key for schools
            $table->string('event_name'); // Event name
            $table->text('event_description'); // Event description
            $table->date('event_date'); // Event date
            $table->string('event_location'); // Event location
            $table->timestamps(); // Created at, updated at
        });
    }

    // 2025_09_18_213009_create_branches_table
    public function up()
    {
        Schema::create('branches', function (Blueprint $table) {
            $table->id();
            $table->foreignId('school_id')->constrained('schools')->onDelete('cascade');
            $table->string('name'); // Branch name (could be same as main school or different)
            $table->string('address');
            $table->string('city');
            $table->string('contact_number')->nullable();
            $table->string('branch_head_name')->nullable(); // Principal/Head of branch
            $table->decimal('latitude', 10, 8)->nullable(); // For maps
            $table->decimal('longitude', 11, 8)->nullable(); // For maps
            $table->boolean('is_main_branch')->default(false); // Flag for main branch
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->timestamps();

            // Indexes
            $table->index('school_id');
            $table->index('city');
            $table->index('is_main_branch');
        });
    }

    public function up()
    {
        Schema::table('events', function (Blueprint $table) {
            $table->foreignId('branch_id')->nullable()->after('school_id')
                ->constrained('branches')->onDelete('cascade');
        });
    }


    // 2025_09_18_213308_add_branch_id_to_reviews_table
    public function up()
    {
        Schema::table('reviews', function (Blueprint $table) {
            $table->foreignId('branch_id')
                ->nullable()
                ->after('school_id')
                ->constrained('branches')
                ->onDelete('cascade');
        });
    }

    // 2025_09_18_214550_create_personal_access_tokens_table
    public function up(): void
    {
        Schema::create('personal_access_tokens', function (Blueprint $table) {
            $table->id();
            $table->morphs('tokenable');
            $table->text('name');
            $table->string('token', 64)->unique();
            $table->text('abilities')->nullable();
            $table->timestamp('last_used_at')->nullable();
            $table->timestamp('expires_at')->nullable()->index();
            $table->timestamps();
        });
    }

    // 2025_09_18_233728_create_permission_tables

    public function up(): void
    {
        $teams = config('permission.teams');
        $tableNames = config('permission.table_names');
        $columnNames = config('permission.column_names');
        $pivotRole = $columnNames['role_pivot_key'] ?? 'role_id';
        $pivotPermission = $columnNames['permission_pivot_key'] ?? 'permission_id';

        throw_if(empty($tableNames), new Exception('Error: config/permission.php not loaded. Run [php artisan config:clear] and try again.'));
        throw_if($teams && empty($columnNames['team_foreign_key'] ?? null), new Exception('Error: team_foreign_key on config/permission.php not loaded. Run [php artisan config:clear] and try again.'));

        Schema::create($tableNames['permissions'], static function (Blueprint $table) {
            // $table->engine('InnoDB');
            $table->bigIncrements('id'); // permission id
            $table->string('name');       // For MyISAM use string('name', 225); // (or 166 for InnoDB with Redundant/Compact row format)
            $table->string('guard_name'); // For MyISAM use string('guard_name', 25);
            $table->timestamps();

            $table->unique(['name', 'guard_name']);
        });

        Schema::create($tableNames['roles'], static function (Blueprint $table) use ($teams, $columnNames) {
            // $table->engine('InnoDB');
            $table->bigIncrements('id'); // role id
            if ($teams || config('permission.testing')) { // permission.testing is a fix for sqlite testing
                $table->unsignedBigInteger($columnNames['team_foreign_key'])->nullable();
                $table->index($columnNames['team_foreign_key'], 'roles_team_foreign_key_index');
            }
            $table->string('name');       // For MyISAM use string('name', 225); // (or 166 for InnoDB with Redundant/Compact row format)
            $table->string('guard_name'); // For MyISAM use string('guard_name', 25);
            $table->timestamps();
            if ($teams || config('permission.testing')) {
                $table->unique([$columnNames['team_foreign_key'], 'name', 'guard_name']);
            } else {
                $table->unique(['name', 'guard_name']);
            }
        });

        Schema::create($tableNames['model_has_permissions'], static function (Blueprint $table) use ($tableNames, $columnNames, $pivotPermission, $teams) {
            $table->unsignedBigInteger($pivotPermission);

            $table->string('model_type');
            $table->unsignedBigInteger($columnNames['model_morph_key']);
            $table->index([$columnNames['model_morph_key'], 'model_type'], 'model_has_permissions_model_id_model_type_index');

            $table->foreign($pivotPermission)
                ->references('id') // permission id
                ->on($tableNames['permissions'])
                ->onDelete('cascade');
            if ($teams) {
                $table->unsignedBigInteger($columnNames['team_foreign_key']);
                $table->index($columnNames['team_foreign_key'], 'model_has_permissions_team_foreign_key_index');

                $table->primary([$columnNames['team_foreign_key'], $pivotPermission, $columnNames['model_morph_key'], 'model_type'],
                    'model_has_permissions_permission_model_type_primary');
            } else {
                $table->primary([$pivotPermission, $columnNames['model_morph_key'], 'model_type'],
                    'model_has_permissions_permission_model_type_primary');
            }

        });

        Schema::create($tableNames['model_has_roles'], static function (Blueprint $table) use ($tableNames, $columnNames, $pivotRole, $teams) {
            $table->unsignedBigInteger($pivotRole);

            $table->string('model_type');
            $table->unsignedBigInteger($columnNames['model_morph_key']);
            $table->index([$columnNames['model_morph_key'], 'model_type'], 'model_has_roles_model_id_model_type_index');

            $table->foreign($pivotRole)
                ->references('id') // role id
                ->on($tableNames['roles'])
                ->onDelete('cascade');
            if ($teams) {
                $table->unsignedBigInteger($columnNames['team_foreign_key']);
                $table->index($columnNames['team_foreign_key'], 'model_has_roles_team_foreign_key_index');

                $table->primary([$columnNames['team_foreign_key'], $pivotRole, $columnNames['model_morph_key'], 'model_type'],
                    'model_has_roles_role_model_type_primary');
            } else {
                $table->primary([$pivotRole, $columnNames['model_morph_key'], 'model_type'],
                    'model_has_roles_role_model_type_primary');
            }
        });

        Schema::create($tableNames['role_has_permissions'], static function (Blueprint $table) use ($tableNames, $pivotRole, $pivotPermission) {
            $table->unsignedBigInteger($pivotPermission);
            $table->unsignedBigInteger($pivotRole);

            $table->foreign($pivotPermission)
                ->references('id') // permission id
                ->on($tableNames['permissions'])
                ->onDelete('cascade');

            $table->foreign($pivotRole)
                ->references('id') // role id
                ->on($tableNames['roles'])
                ->onDelete('cascade');

            $table->primary([$pivotPermission, $pivotRole], 'role_has_permissions_permission_id_role_id_primary');
        });

        app('cache')
            ->store(config('permission.cache.store') != 'default' ? config('permission.cache.store') : null)
            ->forget(config('permission.cache.key'));
    }


    // 2025_10_02_204529_create_pages_table
    public function up()
    {
        Schema::create('pages', function (Blueprint $table) {
            $table->id(); // Auto-increment primary key
            $table->uuid('uuid')->unique();
            $table->foreignId('school_id')->constrained('schools')->onDelete('cascade');
            $table->foreignId('event_id')->nullable()->constrained('events')->onDelete('cascade');
            $table->string('name')->notNullable();
            $table->string('slug')->nullable();
            $table->json('structure')->notNullable(); // This will store your form data
            $table->timestamps(); // created_at and updated_at

            // Indexes
            $table->index('event_id');
            $table->index('slug');
            $table->index('name');
        });
    }

    // 2025_10_02_211339_add_status_to_events_table
    public function up()
    {
        Schema::table('events', function (Blueprint $table) {
            $table->enum('status', ['active', 'inactive'])->default('active');
        });
    }

    // 2025_10_18_064945_create_school_images_table
    public function up(): void
    {
        Schema::create('school_images', function (Blueprint $table) {
            $table->id();
            $table->foreignId('school_id')->constrained('schools')->onDelete('cascade');

            $table->string('image_path');   // store file path
            $table->string('title')->nullable(); // image title/caption
            $table->timestamps();
            $table->index('school_id');
        });
    }

    // 2025_10_18_065015_add_banner_image_to_schools_table
    public function up(): void
    {
        Schema::table('schools', function (Blueprint $table) {
            $table->string('banner_image')->nullable()->after('description');
        });
    }


    // 2025_10_21_035303_create_features_table
    public function up()
    {
        Schema::create('features', function (Blueprint $table) {
            $table->id();
            $table->string('name')->unique();
            $table->string('category')->default('general');
            $table->string('icon')->nullable();
            $table->text('description')->nullable();
            $table->timestamps();

            $table->index('category');
        });
    }

    // 2025_10_21_035310_create_school_feature_table
    public function up()
    {
        Schema::create('school_feature', function (Blueprint $table) {
            $table->id();
            $table->foreignId('school_id')->constrained()->onDelete('cascade');
            $table->foreignId('feature_id')->constrained()->onDelete('cascade');
            $table->text('description')->nullable();
            $table->integer('priority')->default(0);
            $table->timestamps();

            $table->unique(['school_id', 'feature_id']);
            $table->index('priority');
        });
    }

    // 2025_10_21_035317_create_curriculums_table
    public function up()
    {
        Schema::create('curriculums', function (Blueprint $table) {
            $table->id();
            $table->string('name')->unique();
            $table->string('code')->unique();
            $table->text('description')->nullable();
            $table->timestamps();
        });
    }

    // 2025_10_21_035325_create_school_curriculum_table
    public function up()
    {
        Schema::create('school_curriculum', function (Blueprint $table) {
            $table->id();
            $table->foreignId('school_id')->constrained()->onDelete('cascade');
            $table->foreignId('curriculum_id')->constrained('curriculums')->onDelete('cascade'); // Explicitly specify table name
            $table->timestamps();

            $table->unique(['school_id', 'curriculum_id']);
        });
    }
    // 2025_10_22_064141_add_banner_fields_to_schools_table
    public function up(): void
    {
        Schema::table('schools', function (Blueprint $table) {
            $table->string('banner_title')->nullable()->after('banner_image');
            $table->string('banner_tagline')->nullable()->after('banner_title');
        });
    }

     // 2025_10_22_094622_create_school_profiles_table
    public function up()
    {
        Schema::create('school_profiles', function (Blueprint $table) {
            $table->id();
            $table->foreignId('school_id')->constrained()->onDelete('cascade');

            // Quick Facts (JSON format for flexibility)
            $table->json('quick_facts')->nullable();

            // School Logo
            $table->string('logo')->nullable();

            // Social Media Links (JSON format)
            $table->json('social_media')->nullable();

            // Analytics
            $table->integer('visitor_count')->default(0);
            $table->bigInteger('total_time_spent')->default(0); // in seconds
            $table->timestamp('last_visited_at')->nullable();

            // Additional profile fields you might need
            $table->string('established_year')->nullable();
            $table->integer('student_strength')->nullable();
            $table->integer('faculty_count')->nullable();
            $table->string('campus_size')->nullable();
            $table->string('school_motto')->nullable();
            $table->text('mission')->nullable();
            $table->text('vision')->nullable();

            $table->timestamps();

            // Indexes
            $table->unique('school_id');
            $table->index('visitor_count');
        });
    }

    // 2025_10_22_103514_add_logo_to_schools_table
    public function up(): void
    {
        Schema::table('schools', function (Blueprint $table) {
            $table->string('logo')->nullable()->after('banner_tagline');
        });
    }

    // 2025_10_22_140413_add_user_id_to_reviews_table
    public function up()
    {
        Schema::table('reviews', function (Blueprint $table) {
            $table->foreignId('user_id')->nullable()->constrained()->onDelete('cascade');
            // Make reviewer_name nullable since authenticated users might not need it
            $table->string('reviewer_name')->nullable()->change();
        });
    }

    // 2025_10_23_205941_add_element_columns_to_pages_table
    public function up()
    {
        Schema::table('pages', function (Blueprint $table) {
            // Add new columns for individual element types
            $table->json('title')->nullable()->after('structure');
            $table->json('banner')->nullable()->after('title');
            $table->json('image')->nullable()->after('banner');
            $table->json('rich_text')->nullable()->after('image');
            $table->json('text_left_image_right')->nullable()->after('rich_text');
            $table->json('custom_html')->nullable()->after('text_left_image_right');

            // You can also add a general elements column to store all canvas elements
            $table->json('canvas_elements')->nullable()->after('custom_html');
        });
    }

    // 2025_10_24_110548_create_school_image_galleries_table
    public function up()
    {
        Schema::create('school_image_galleries', function (Blueprint $table) {
            $table->id();
            $table->uuid('uuid')->unique();
            $table->foreignId('school_id')->constrained()->onDelete('cascade');
            $table->string('image_path');
            $table->string('image_name');
            $table->string('image_unique_name')->unique();
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->timestamps();

            $table->index(['school_id', 'status']);
        });
    }

    // 2025_10_24_182517_add_profile_columns_to_users_table
    public function up()
    {
        Schema::table('users', function (Blueprint $table) {
            $table->string('phone')->nullable()->after('school_id');
            $table->text('address')->nullable()->after('phone');
            $table->text('bio')->nullable()->after('address');
            $table->string('profile_picture')->nullable()->after('bio');
        });
    }


    // 2025_10_26_110932_add_fields_to_pages_table
    public function up(): void
    {
        Schema::table('pages', function (Blueprint $table) {
            $table->text('description')->nullable()->after('slug');
            $table->string('feature_image')->nullable()->after('description');
            $table->date('start_date')->nullable()->after('feature_image');
            $table->date('end_date')->nullable()->after('start_date');
            $table->enum('status', ['active', 'pending', 'inactive'])->default('pending')->after('end_date');
        });
    }



    Schema::create('shops', function (Blueprint $table) {
            $table->id();
            $table->uuid('uuid')->unique();
            $table->foreignId('user_id')->constrained()->onDelete('cascade');
            $table->string('name');
            $table->string('slug')->unique();
            $table->string('email')->nullable();
            $table->string('phone', 20)->nullable();
            $table->text('address')->nullable();
            $table->string('city')->nullable();
            $table->string('state')->nullable();
            $table->string('country')->default('Pakistan');

            $table->decimal('latitude', 10, 8)->nullable();
            $table->decimal('longitude', 11, 8)->nullable();

            $table->enum('shop_type', ['stationery', 'book_store', 'mixed', 'school_affiliated'])->default('mixed');
            $table->text('description')->nullable();

            $table->string('logo_url')->nullable();
            $table->string('banner_url')->nullable();

            $table->boolean('is_verified')->default(false);
            $table->boolean('is_active')->default(true);
            $table->decimal('rating', 3, 2)->default(0.00);
            $table->integer('total_reviews')->default(0);

            $table->timestamps();

            // Indexes
            $table->index(['city', 'state']);
            $table->index('shop_type');
            $table->index(['is_verified', 'is_active']);
        });

        Schema::create('product_categories', function (Blueprint $table) {
            $table->id();
            $table->uuid('uuid')->unique();
            $table->string('name');
            $table->string('slug')->unique();
            $table->foreignId('parent_id')->nullable()->constrained('product_categories')->onDelete('set null');

            $table->text('description')->nullable();
            $table->string('image_url')->nullable();
            $table->string('icon')->nullable();
            $table->integer('sort_order')->default(0);
            $table->boolean('is_active')->default(true);

            $table->timestamps();

            // Indexes
            $table->index('parent_id');
            $table->index(['is_active', 'sort_order']);
            $table->index('slug');
        });


        Schema::create('shop_school_associations', function (Blueprint $table) {
            $table->id();
            $table->uuid('uuid')->unique();
            $table->foreignId('shop_id')->constrained()->onDelete('cascade');
            $table->foreignId('school_id')->constrained()->onDelete('cascade');
            $table->foreignId('created_by')->nullable()->constrained('users')->onDelete('set null');

            $table->enum('association_type', ['preferred', 'official', 'affiliated', 'general'])->default('general');
            $table->decimal('discount_percentage', 5, 2)->default(0);
            $table->boolean('is_active')->default(true);

            // Additional fields for better management
            $table->enum('status', ['pending', 'approved', 'rejected'])->default('pending');
            $table->timestamp('approved_at')->nullable();
            $table->foreignId('approved_by')->nullable()->constrained('users')->onDelete('set null');

            // Permissions for this specific association
            $table->boolean('can_add_products')->default(true);
            $table->boolean('can_manage_products')->default(true);
            $table->boolean('can_view_analytics')->default(true);

            $table->text('notes')->nullable();

            $table->timestamps();

            // Indexes
            $table->unique(['shop_id', 'school_id']);
            $table->index(['school_id', 'is_active']);
            $table->index('association_type');
            $table->index('status');
            $table->index('created_by');
        });

        Schema::create('products', function (Blueprint $table) {
            $table->id();
            $table->uuid('uuid')->unique();
            $table->foreignId('shop_id')->constrained()->onDelete('cascade');
            $table->foreignId('category_id')->constrained('product_categories')->onDelete('restrict');
            $table->foreignId('school_id')->nullable()->constrained()->onDelete('set null');
            $table->foreignId('association_id')->nullable()->constrained('shop_school_associations')->onDelete('cascade');

            $table->string('name');
            $table->string('slug');
            $table->string('sku')->unique()->nullable();
            $table->text('description')->nullable();
            $table->text('short_description')->nullable();

            $table->enum('product_type', ['book', 'copy', 'stationery', 'bag', 'uniform', 'other'])->default('other');

            // Common product attributes
            $table->string('brand')->nullable();
            $table->string('material')->nullable();
            $table->string('color')->nullable();
            $table->string('size')->nullable();

            // Pricing
            $table->decimal('base_price', 10, 2);
            $table->decimal('sale_price', 10, 2)->nullable();
            $table->decimal('cost_price', 10, 2)->nullable();
            $table->decimal('profit_margin', 5, 2)->nullable();

            // Inventory
            $table->integer('stock_quantity')->default(0);
            $table->integer('low_stock_threshold')->default(5);
            $table->boolean('manage_stock')->default(true);
            $table->boolean('is_in_stock')->default(true);

            // Product status
            $table->boolean('is_featured')->default(false);
            $table->boolean('is_active')->default(true);
            $table->boolean('is_approved')->default(false);

            // SEO
            $table->string('meta_title')->nullable();
            $table->text('meta_description')->nullable();
            $table->text('meta_keywords')->nullable();

            // Media
            $table->string('main_image_url')->nullable();
            $table->json('image_gallery')->nullable();

            $table->timestamps();

            // Indexes
            $table->unique(['shop_id', 'slug']);
            $table->index('product_type');
            $table->index(['is_active', 'is_approved']);
            $table->index('base_price');
            $table->index(['is_in_stock', 'stock_quantity']);
            $table->index('school_id');
            $table->index('association_id');
            $table->index('sku');
        });

        Schema::create('product_attributes', function (Blueprint $table) {
            $table->id();
            $table->uuid('uuid')->unique();
            $table->foreignId('product_id')->constrained()->onDelete('cascade');

            $table->enum('attribute_type', ['book', 'copy', 'bag', 'uniform'])->default('book');

            // Book specific attributes
            $table->string('book_author')->nullable();
            $table->string('book_publisher')->nullable();
            $table->string('book_isbn', 20)->nullable();
            $table->string('book_edition', 50)->nullable();
            $table->year('book_publication_year')->nullable();
            $table->enum('education_board', [
                'federal',
                'punjab',
                'sindh',
                'kpk',
                'balochistan',
                'ajk',
                'cambridge',
                'ib',
                'other'
            ])->nullable();
            $table->string('school_name')->nullable();
            $table->string('class_level', 50)->nullable(); // e.g., "Class 1", "Grade 5", "O-Levels"
            $table->string('subject', 100)->nullable();
            $table->enum('medium', ['english', 'urdu', 'bilingual', 'other'])->nullable();

            // Copy specific attributes
            $table->integer('copy_pages')->nullable();
            $table->enum('copy_quality', ['premium', 'standard', 'economy'])->nullable();
            $table->enum('copy_size', ['a4', 'a5', 'quarter', 'half', 'other'])->nullable();
            $table->enum('copy_type', ['single_line', 'double_line', 'four_line', 'plain', 'graph'])->nullable();

            // Bag specific attributes
            $table->enum('bag_type', ['school_bag', 'backpack', 'satchel', 'lunch_bag', 'other'])->nullable();
            $table->integer('bag_compartments')->nullable();
            $table->boolean('bag_water_resistant')->default(false);
            $table->boolean('bag_wheels')->default(false);

            // Common measurements
            $table->decimal('weight_grams', 8, 2)->nullable();
            $table->string('dimensions', 100)->nullable(); // "LxWxH" format

            $table->timestamps();

            // Indexes
            $table->index('attribute_type');
            $table->index(['education_board', 'class_level']);
            $table->index(['book_author', 'book_publisher']);
            $table->index('class_level');
            $table->index('subject');
        });

        Schema::create('orders', function (Blueprint $table) {
            $table->id();
            $table->uuid('uuid')->unique();

            // User and Shop relationships
            $table->foreignId('user_id')->constrained()->onDelete('cascade');
            $table->foreignId('shop_id')->constrained()->onDelete('cascade');
            $table->foreignId('school_id')->nullable()->constrained()->onDelete('set null');

            // Order information
            $table->string('order_number')->unique();
            $table->enum('status', [
                'pending',
                'confirmed',
                'processing',
                'shipped',
                'delivered',
                'cancelled',
                'refunded',
                'failed'
            ])->default('pending');

            // Pricing breakdown
            $table->decimal('subtotal', 12, 2)->default(0);
            $table->decimal('shipping_cost', 8, 2)->default(0);
            $table->decimal('tax_amount', 8, 2)->default(0);
            $table->decimal('discount_amount', 8, 2)->default(0);
            $table->decimal('total_amount', 12, 2)->default(0);

            // Payment information
            $table->enum('payment_method', [
                'credit_card',
                'debit_card',
                'cash_on_delivery',
                'digital_wallet',
                'bank_transfer'
            ])->default('cash_on_delivery');

            $table->enum('payment_status', [
                'pending',
                'paid',
                'failed',
                'refunded',
                'partially_refunded'
            ])->default('pending');

            $table->string('transaction_id')->nullable()->unique();
            $table->timestamp('paid_at')->nullable();

            // Shipping information
            $table->string('shipping_first_name');
            $table->string('shipping_last_name');
            $table->string('shipping_email');
            $table->string('shipping_phone');
            $table->text('shipping_address');
            $table->string('shipping_city');
            $table->string('shipping_state');
            $table->string('shipping_zip_code');
            $table->string('shipping_country')->default('Pakistan');
            $table->text('delivery_instructions')->nullable();

            // Billing information (can be same as shipping)
            $table->boolean('billing_same_as_shipping')->default(true);
            $table->string('billing_first_name')->nullable();
            $table->string('billing_last_name')->nullable();
            $table->string('billing_email')->nullable();
            $table->string('billing_phone')->nullable();
            $table->text('billing_address')->nullable();
            $table->string('billing_city')->nullable();
            $table->string('billing_state')->nullable();
            $table->string('billing_zip_code')->nullable();
            $table->string('billing_country')->nullable();

            // Order metadata
            $table->text('customer_notes')->nullable();
            $table->text('admin_notes')->nullable();
            $table->json('metadata')->nullable(); // For additional custom data

            // Timestamps for order lifecycle
            $table->timestamp('confirmed_at')->nullable();
            $table->timestamp('processing_at')->nullable();
            $table->timestamp('shipped_at')->nullable();
            $table->timestamp('delivered_at')->nullable();
            $table->timestamp('cancelled_at')->nullable();

            // Estimated delivery
            $table->timestamp('estimated_delivery_date')->nullable();

            $table->timestamps();

            // Indexes for performance
            $table->index('order_number');
            $table->index('user_id');
            $table->index('shop_id');
            $table->index('school_id');
            $table->index('status');
            $table->index('payment_status');
            $table->index('payment_method');
            $table->index('created_at');
            $table->index(['status', 'created_at']);
            $table->index(['shop_id', 'status']);
        });
        Schema::create('order_items', function (Blueprint $table) {
            $table->id();
            $table->uuid('uuid')->unique();

            // Relationships
            $table->foreignId('order_id')->constrained()->onDelete('cascade');
            $table->foreignId('product_id')->constrained()->onDelete('cascade');
            $table->foreignId('shop_id')->constrained()->onDelete('cascade');

            // Product snapshot at time of order (in case product details change later)
            $table->string('product_name');
            $table->text('product_description')->nullable();
            $table->string('product_sku')->nullable();
            $table->string('product_image')->nullable();
            $table->json('product_attributes')->nullable(); // Store product attributes as JSON

            // Pricing
            $table->decimal('unit_price', 10, 2);
            $table->decimal('sale_price', 10, 2)->nullable();
            $table->decimal('discount_amount', 8, 2)->default(0);
            $table->decimal('tax_amount', 8, 2)->default(0);
            $table->integer('quantity');
            $table->decimal('total_price', 12, 2);

            // Product category information
            $table->foreignId('category_id')->nullable()->constrained('product_categories')->onDelete('set null');
            $table->string('category_name')->nullable();

            // School association (if any)
            $table->foreignId('school_id')->nullable()->constrained()->onDelete('set null');
            $table->foreignId('association_id')->nullable()->constrained('shop_school_associations')->onDelete('set null');

            // Item status
            $table->enum('status', [
                'pending',
                'confirmed',
                'shipped',
                'delivered',
                'cancelled',
                'refunded'
            ])->default('pending');

            $table->text('cancellation_reason')->nullable();
            $table->timestamp('cancelled_at')->nullable();

            $table->timestamps();

            // Indexes
            $table->index('order_id');
            $table->index('product_id');
            $table->index('shop_id');
            $table->index('category_id');
            $table->index('school_id');
            $table->index('status');
            $table->index(['order_id', 'status']);
        });

        Schema::create('coupons', function (Blueprint $table) {
            $table->id();
            $table->uuid('uuid')->unique();

            // Basic coupon info
            $table->string('code')->unique();
            $table->string('name');
            $table->text('description')->nullable();

            // Discount details
            $table->enum('discount_type', ['percentage', 'fixed_amount', 'free_shipping'])->default('percentage');
            $table->decimal('discount_value', 10, 2);
            $table->decimal('minimum_order_amount', 10, 2)->nullable();
            $table->decimal('maximum_discount_amount', 10, 2)->nullable();

            // Usage limits
            $table->integer('usage_limit')->nullable();
            $table->integer('usage_count')->default(0);
            $table->integer('usage_per_customer')->nullable();

            // Validity
            $table->timestamp('valid_from')->nullable();
            $table->timestamp('valid_until')->nullable();

            // Scope
            $table->enum('scope', ['global', 'shop_specific', 'school_specific', 'product_specific'])->default('global');

            // Status
            $table->boolean('is_active')->default(true);
            $table->boolean('is_featured')->default(false);

            $table->timestamps();

            // Indexes
            $table->index('code');
            $table->index(['is_active', 'valid_until']);
            $table->index('scope');
        });
        Schema::create('coupon_applicables', function (Blueprint $table) {
            $table->id();
            $table->foreignId('coupon_id')->constrained()->onDelete('cascade');

            // Polymorphic relation
            $table->morphs('applicable'); // creates applicable_id + applicable_type

            $table->timestamps();

            // Indexes
            $table->unique(['coupon_id', 'applicable_id', 'applicable_type']);
            $table->index(['applicable_id', 'applicable_type']);
        });
         Schema::create('coupon_usage', function (Blueprint $table) {
            $table->id();
            $table->foreignId('coupon_id')->constrained()->onDelete('cascade');
            $table->foreignId('user_id')->constrained()->onDelete('cascade');
            $table->foreignId('order_id')->constrained()->onDelete('cascade');

            $table->decimal('discount_amount', 10, 2);

            $table->timestamps();

            // Indexes
            $table->index(['coupon_id', 'user_id']);
            $table->index('order_id');
        });